from tth import *
import unittest

class TestTigerTree(unittest.TestCase):
    def test_vectors(self):
        self.assertEqual(TigerTree("\x00" * 40), TigerTree("\x00" * 40));
        self.assertEqual(TigerTree("").base32(), "LWPNACQDBZRYXW3VHJVCJ64QBZNGHOHHHZWCLNQ=");
        self.assertEqual(TigerTree("\x00").base32(), "VK54ZIEEVTWNAUI5D5RDFIL37LX2IQNSTAXFKSA=");
        self.assertEqual(TigerTree("A" * 1024).base32(), "L66Q4YVNAFWVS23X2HJIRA5ZJ7WXR3F26RSASFA=");
        self.assertEqual(TigerTree("A" * 1025).base32(), "PZMRYHGY6LTBEH63ZWAHDORHSYTLO4LEFUIKHWY=");

    def test_references_d6(self):
        ref1 = [
            "3AHZO3HIOHYES7JHIWDU63U6ED6YSZWFMN3J2UQ=",
            "AC74ZZ46JTWNG75RR7G7OBHZFCIX3WGO3QCVSMQ=",
            "E4D3IRNZ3U26QC32ESKUSAXER2QNEFROW4OUL6Q=",
            "YJCIYNJN7WS7TP7REG45UVVEDOXI43WEUN46KFQ=",
            "TRPCVMJOSRGKT4T4623PAVTW6M4RPXGLFT6YOJQ=",
            "JCDF35PE7MLPAUYGFWSFKYKPZKUQI77D2UR6MHI=",
            "CNBKBJL3P45HTG2IMLFSNLEDRJFEMLZKOLLW4CA=",
            "3HFHD5QLI5WLM442HUSAHFPC5QDOW654C4XLHKI=",
            "JLU5MAEP5QIL6BTTRLLA7IMOHVWR3KN4AWBSQNA=",
            "U353DFAO7PZJ6OXFMZLL3TILBANAMRDAC7VGWPA=",
            "2DNRYP2LWG3GHRQH6N2BSCKHJZNDSI4CBOR5GRI=",
            "IQXUACJ4ROLOG3UU5EAZWE5LCCGUXPXF3CISOZI=",
            "NHXHZ5BZX27STG5P622IAF7C4UWIIU6KLDDVQIY=",
            "56JVQZWHWJ6QX3LMOAG3UH24EFHA2Y4GMY763KQ=",
            "2RE73LIOQEN5F2PHFWBCODFVW4A5OLSCNZGIVBY=",
        ];
        
        for i, ref in zip(range(17, 32), ref1):
            t1 = TigerTree("A" * (i * TigerTree.segment));
            t2 = TigerTree.deserialize(t1.serialize(), 6);
            self.assertEqual(t1, t2, "17-32 with depth 6 failed");
            self.assertEqual(t1.base32(), ref, "t1 reference invalid");
            self.assertEqual(t2.base32(), ref, "t2 reference invalid");
    
    def test_references_d7(self):
        ref2 = [
            "XNZDHTRMC5NW4PE2DDFUSCDFBU5EMTBP5IKRGUY=",
            "XAK46S52HLTLDFWSLMTASRAY6O6HANEIJJWSQSI=",
            "HHQ6SBUHJMEGZ4HKLCE7DLPFJVD6DNBWPWMEJDI=",
            "7O6FNPFGUBLWXSIHQZ6MFXKBF3K6VWGQIDBKC3Q=",
            "ICX747MBQUDLFGLTUJIWK3RZSXLLOWS4FEG2SKQ=",
            "ZYNT5VQGWM2E5YRAH6XTJXJL6T6CZY62JKIGNJY=",
            "LOUUEQWTVJAMEZLIQCCOVGU2IEB3I2F454R2D7Y=",
            "HQQYBAPCDHNWNQO6OEXEDPZP7OLCTL33JKQY5TQ=",
            "2FGTKPIQKYGEBUCHQCGA7ELJHMHHDW5R4CUL37I=",
            "7COE4562JXSULAB5LXFJL2L6UWPP4N2YEU3TLNI=",
            "TXCR2XPMGBPGRF6S5SUVV23ZH5OJXWRIEB6ZTNY=",
            "NREFVXWWSJQFP35TY3ZQGLOXMIAKNFKYPPUXSCY=",
            "4HO6RQO7QF2WVQHEN4Y2BF4DQXVKARQ73MVAQSA=",
            "NZJQSATY7AHONAUOMYWJ6B65LIHOEEME5TERXQY=",
            "PUGBMNL3EP3DEWZGZND5I56GAZRN42IKKZ55DMI=",
            "5W73YLNSKE26X3CVKK33SEWPJBPE6LZ2ADFAW4Y=",
            "C6ORLVQJ7HSQYIFATMQU3VRMMQE4VJDA6VEFLII=",
            "2BFWHF7DL2YU2IDNL67UNMUANUVSD3TP3EQNNYA=",
            "7AMKR2MHOAIYSH7W7HQZTJUYQZDIXTD6IA5VPMY=",
            "MWQTUYIW5UZD7F2GQ2RLHKRI5ZWGCCKEGJLF6VY=",
            "CSB56ETF3FNGSK2OQQTJIAW44VUBIPXXIDTIG4Y=",
            "CADR4ZAYXUW7E3S7U7TOAEUTQDXM7ENW25UIZ2A=",
            "NYHX6H7HLANA3SOO3V7IDGKY6U7YCJXIZDNMVBI=",
            "Z3Z5QJUKA2IVQMRMGWLXXK7J43QSDGGYI4RAZRY=",
            "J335V4B2YZSYZVBGDH6OCF7O7KJNL4E6OXCJC2Y=",
            "ABQUFZB3N4ADSPTG7IVSB6VNY4O2PWIAVNM3V6I=",
            "CUMRKM7TTGWR4PZLBVZG3HTBYSR3DX4WIX4HZUI=",
            "EFN3BN6E74X7IMG5I2JAFDK5IN6BKMY6LHTZSPA=",
            "DBYB5TFO6I45UB6DMPHJ7CGXUTODBXGK32D7UTY=",
            "PBMGKC46EPIRARYUU5BDR3DCBMAHZLAKW6ILIHY=",
            "FSM6YZ6LNISIYM4RTRH4SLKSXEESKECYYSVOKWQ=",
        ];
        
        for i, ref in zip(range(33, 64), ref2):
            t1 = TigerTree("A" * (i * TigerTree.segment));
            t2 = TigerTree.deserialize(t1.serialize(), 7);
            self.assertEqual(t1, t2, "33-64 with depth 7 failed");
            self.assertEqual(t1.base32(), ref, "t1 reference invalid");
            self.assertEqual(t2.base32(), ref, "t2 reference invalid");

if __name__ == "__main__":
    unittest.main()
